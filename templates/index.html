<!DOCTYPE html>
<html>
<head>
    <title>Mahsoub</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
</head>
<body>
    <h1>Welcome to Mahsoub!</h1>
    <p>This is your gym tracker application. Start tracking today!</p>
</body>
<h2>Add an Exercise</h2>
<form id="exerciseForm">
    <label for="name">Exercise Name:</label><br>
    <input type="text" id="name" name="name" required><br>

    <label for="reps">Repetitions:</label><br>
    <input type="number" id="reps" name="reps" required><br>

    <label for="weight">Weight:</label><br>
    <input type="number" id="weight" name="weight"><br>

    <label for="duration">Duration (mins):</label><br>
    <input type="number" id="duration" name="duration"><br><br>

    <button type="submit">Submit</button>
</form>
<script>
    const form = document.getElementById('exerciseForm');
    form.onsubmit = async function(e) {
        e.preventDefault();
        const data = {
            name: form.name.value,
            repetitions: form.reps.value,
            weight: form.weight.value,
            duration: form.duration.value
        };
        await fetch('/add-exercise', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        alert('Exercise added!');
    };
</script>
<h2>Exercise History</h2>
<table border="1" id="exerciseTable">
    <thead>
        <tr>
            <th>ID</th>
            <th>Exercise Name</th>
            <th>Repetitions</th>
            <th>Weight</th>
            <th>Duration</th>
            <th>Date Created</th>
        </tr>
    </thead>
    <tbody>
    </tbody>
</table>
<script>
    // Fetch and display exercises in the table
    async function loadExercises() {
        const response = await fetch('/exercises');
        const exercises = await response.json();
        const tableBody = document.getElementById('exerciseTable').getElementsByTagName('tbody')[0];
        tableBody.innerHTML = '';
        exercises.forEach((exercise) => {
            const row = `<tr>
                <td>${exercise.id}</td>
                <td>${exercise.name}</td>
                <td>${exercise.repetitions}</td>
                <td>${exercise.weight ?? 'N/A'}</td>
                <td>${exercise.duration ?? 'N/A'} min</td>
                <td>${new Date(exercise.created_at).toLocaleString()}</td>
            </tr>`;
            tableBody.innerHTML += row;
        });
    }

    // Load data on page load
    window.onload = loadExercises;
</script>
</html>
